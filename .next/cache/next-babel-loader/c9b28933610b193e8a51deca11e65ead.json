{"ast":null,"code":"import fetch from 'isomorphic-unfetch';\nimport getServerHost from './getServerHost';\nimport nextCookie from 'next-cookies';\nimport cookie from 'js-cookie';\nexport default (async ctx => {\n  let token = '';\n\n  if (ctx === undefined) {\n    if (!false) {\n      console.error(`Missing ctx in getUser`);\n      return null;\n    }\n\n    token = cookie.get('token');\n  } else {\n    token = nextCookie(ctx).token;\n  }\n\n  try {\n    const response = await fetch(`${getServerHost(ctx === null || ctx === void 0 ? void 0 : ctx.req)}/auth/user`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n\n    if (response.ok) {\n      return await response.json();\n    } else {\n      return null;\n    }\n  } catch (error) {\n    return null;\n  }\n});","map":{"version":3,"sources":["C:/Users/Artur/Documents/Programming/ig/relay/www/client/utils/getUser.ts"],"names":["fetch","getServerHost","nextCookie","cookie","ctx","token","undefined","console","error","get","response","req","headers","Authorization","ok","json"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,oBAAlB;AACA,OAAOC,aAAP,MAA0B,iBAA1B;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AAEA,gBAAe,MAAOC,GAAP,IAAqB;AAClC,MAAIC,KAAK,GAAG,EAAZ;;AAEA,MAAGD,GAAG,KAAKE,SAAX,EAAqB;AACnB,QAAG,MAAH,EAAoB;AAClBC,MAAAA,OAAO,CAACC,KAAR,CAAe,wBAAf;AACA,aAAO,IAAP;AACD;;AAEDH,IAAAA,KAAK,GAAGF,MAAM,CAACM,GAAP,CAAW,OAAX,CAAR;AACD,GAPD,MAOO;AACLJ,IAAAA,KAAK,GAAGH,UAAU,CAACE,GAAD,CAAV,CAAgBC,KAAxB;AACD;;AAED,MAAI;AACF,UAAMK,QAAQ,GAAG,MAAMV,KAAK,CAAE,GAAEC,aAAa,CAACG,GAAD,aAACA,GAAD,uBAACA,GAAG,CAAEO,GAAN,CAAW,YAA5B,EAAyC;AAAEC,MAAAA,OAAO,EAAE;AAAEC,QAAAA,aAAa,EAAG,UAASR,KAAM;AAAjC;AAAX,KAAzC,CAA5B;;AAEA,QAAGK,QAAQ,CAACI,EAAZ,EAAe;AACb,aAAO,MAAMJ,QAAQ,CAACK,IAAT,EAAb;AACD,KAFD,MAEO;AACL,aAAO,IAAP;AACD;AACF,GARD,CAQE,OAAOP,KAAP,EAAc;AACd,WAAO,IAAP;AACD;AACF,CAzBD","sourcesContent":["import fetch from 'isomorphic-unfetch'\r\nimport getServerHost from './getServerHost'\r\nimport nextCookie from 'next-cookies'\r\nimport cookie from 'js-cookie'\r\n\r\nexport default async (ctx?: any) => {\r\n  let token = ''\r\n\r\n  if(ctx === undefined){\r\n    if(!process.browser){\r\n      console.error(`Missing ctx in getUser`)\r\n      return null\r\n    }\r\n\r\n    token = cookie.get('token')\r\n  } else {\r\n    token = nextCookie(ctx).token\r\n  }\r\n\r\n  try {\r\n    const response = await fetch(`${getServerHost(ctx?.req)}/auth/user`, { headers: { Authorization: `Bearer ${token}` } })\r\n\r\n    if(response.ok){\r\n      return await response.json()\r\n    } else {\r\n      return null\r\n    }\r\n  } catch (error) {\r\n    return null\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}