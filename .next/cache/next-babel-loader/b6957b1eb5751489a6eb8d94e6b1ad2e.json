{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"C:\\\\Users\\\\Artur\\\\Documents\\\\Programming\\\\ig\\\\relay\\\\www\\\\client\\\\pages\\\\login.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useCallback } from 'react';\nimport { TextField, Button, makeStyles, Card, CardContent, Typography, Avatar, Divider } from '@material-ui/core';\nimport fetch from 'isomorphic-unfetch';\nimport login from '../utils/auth/login';\nimport getServerHost from '../utils/getServerHost';\nimport Layout from '../components/Layout';\nimport { LockOutlined } from '@material-ui/icons';\nimport { connect } from 'react-redux';\nimport getUser from '../utils/getUser';\nconst useStyles = makeStyles(theme => ({\n  card: {\n    maxWidth: 380,\n    margin: '0 auto'\n  },\n  form: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    margin: theme.spacing(2)\n  },\n  title: {\n    margin: theme.spacing(2, 0)\n  },\n  button: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  divider: {\n    margin: theme.spacing(2, 0)\n  },\n  center: {\n    display: 'flex',\n    justifyContent: 'center'\n  }\n}));\n\nconst mapStateToProps = state => ({});\n\nconst mapDispatchToProps = dispatch => ({\n  dispatchLogin: user => dispatch({\n    type: 'login',\n    payload: user\n  })\n});\n\nconst Login = ({\n  dispatchLogin\n}) => {\n  const {\n    0: username,\n    1: setUsername\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const handleSubmit = useCallback(async event => {\n    event.preventDefault();\n\n    try {\n      const response = await fetch(`${getServerHost()}/auth/login`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: _JSON$stringify({\n          username,\n          password\n        })\n      });\n\n      if (response.ok) {\n        const {\n          access_token\n        } = await response.json();\n        login(access_token);\n        const user = await getUser();\n        console.log(user);\n        dispatchLogin(user);\n      } else {\n        console.log('Login failed.');\n      }\n    } catch (error) {\n      console.error('You have an error in your code or there are Network issues.', error);\n    }\n  }, [username, password]);\n  const classes = useStyles({});\n  return __jsx(Layout, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, __jsx(Card, {\n    className: classes.card,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  }, __jsx(CardContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, __jsx(\"form\", {\n    className: classes.form,\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, __jsx(Avatar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, __jsx(LockOutlined, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  })), __jsx(Typography, {\n    component: \"h1\",\n    variant: \"h3\",\n    className: classes.title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, \"Log in\"), __jsx(TextField, {\n    label: \"username\",\n    value: username,\n    onChange: ({\n      target: {\n        value\n      }\n    }) => setUsername(value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }), __jsx(TextField, {\n    label: \"password\",\n    type: \"password\",\n    value: password,\n    onChange: ({\n      target: {\n        value\n      }\n    }) => setPassword(value),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }), __jsx(Button, {\n    type: \"submit\",\n    variant: \"contained\",\n    color: \"primary\",\n    className: classes.button,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, \"Log in\")), __jsx(Divider, {\n    variant: \"fullWidth\",\n    orientation: \"horizontal\",\n    className: classes.divider,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }), __jsx(\"div\", {\n    className: classes.center,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, __jsx(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    disabled: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"log me with google\")))));\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);","map":{"version":3,"sources":["C:/Users/Artur/Documents/Programming/ig/relay/www/client/pages/login.tsx"],"names":["useState","useCallback","TextField","Button","makeStyles","Card","CardContent","Typography","Avatar","Divider","fetch","login","getServerHost","Layout","LockOutlined","connect","getUser","useStyles","theme","card","maxWidth","margin","form","display","flexDirection","alignItems","spacing","title","button","divider","center","justifyContent","mapStateToProps","state","mapDispatchToProps","dispatch","dispatchLogin","user","type","payload","Login","username","setUsername","password","setPassword","handleSubmit","event","preventDefault","response","method","headers","body","ok","access_token","json","console","log","error","classes","target","value"],"mappings":"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","sourcesContent":["import { useState, useCallback } from 'react'\r\nimport { TextField, Button, Theme, makeStyles, Card, CardContent, Typography, Avatar, Divider } from '@material-ui/core'\r\nimport fetch from 'isomorphic-unfetch'\r\nimport login from '../utils/auth/login'\r\nimport getServerHost from '../utils/getServerHost'\r\nimport Layout from '../components/Layout'\r\nimport { LockOutlined } from '@material-ui/icons'\r\nimport { connect } from 'react-redux'\r\nimport getUser from '../utils/getUser'\r\n\r\nconst useStyles = makeStyles((theme: Theme) => ({\r\n  card: {\r\n    maxWidth: 380,\r\n    margin: '0 auto'\r\n  },\r\n  form: {\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    margin: theme.spacing(2)\r\n  },\r\n  title: {\r\n    margin: theme.spacing(2, 0)\r\n  },\r\n  button: {\r\n    margin: theme.spacing(3, 0, 2)\r\n  },\r\n  divider: {\r\n    margin: theme.spacing(2, 0)\r\n  },\r\n  center: {\r\n    display: 'flex',\r\n    justifyContent: 'center'\r\n  }\r\n}))\r\n\r\nconst mapStateToProps = state => ({})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n  dispatchLogin: (user) => \r\n    dispatch({ type: 'login', payload: user })\r\n})\r\n\r\nconst Login = ({ dispatchLogin }) => {\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n\r\n  const handleSubmit = useCallback(async event => {\r\n    event.preventDefault()\r\n\r\n    try {\r\n      const response = await fetch(`${getServerHost()}/auth/login`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ username, password })\r\n      })\r\n      if(response.ok){\r\n        const { access_token } = await response.json()\r\n        login(access_token)\r\n\r\n        const user = await getUser()\r\n        console.log(user)\r\n        dispatchLogin(user)\r\n      } else {\r\n        console.log('Login failed.')\r\n      }\r\n    } catch (error) {\r\n      console.error(\r\n        'You have an error in your code or there are Network issues.',\r\n        error\r\n      )\r\n    }\r\n  }, [username, password])\r\n\r\n  const classes = useStyles({})\r\n  return (\r\n    <Layout>\r\n      <Card className={classes.card}>\r\n        <CardContent>\r\n          <form className={classes.form} onSubmit={handleSubmit}>\r\n            <Avatar>\r\n              <LockOutlined />\r\n            </Avatar>\r\n            <Typography component=\"h1\" variant=\"h3\" className={classes.title}>Log in</Typography>\r\n            <TextField label=\"username\" value={username} onChange={({ target: { value } }) => setUsername(value)} />\r\n            <TextField label=\"password\" type=\"password\" value={password} onChange={({ target: { value } }) => setPassword(value)} />\r\n            <Button type=\"submit\" variant=\"contained\" color=\"primary\" className={classes.button}>Log in</Button>\r\n          </form>\r\n          <Divider variant=\"fullWidth\" orientation=\"horizontal\" className={classes.divider} />\r\n          <div className={classes.center}>\r\n            <Button variant=\"contained\" color=\"primary\" disabled>\r\n              log me with google\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </Layout>\r\n  )\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Login)"]},"metadata":{},"sourceType":"module"}